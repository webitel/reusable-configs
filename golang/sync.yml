group:
  - repos: |
      webitel/webitel-wfm
    
    files:
      - source: golang/.idea
        dest: .idea

      - source: golang/.vscode
        dest: .vscode

      - source: golang/configs/.editorconfig
        dest: .editorconfig

      - source: golang/configs/dependabot.yml
        dest: .github/dependabot.yml

      - source: golang/configs/.env.otel.example
        dest: .env.otel.example

  - repos: |
      webitel/webitel-wfm

    files:
      - source: golang/workflows/workflow.yml.njk
        dest: .github/workflows/workflow.yml
        template:
          name: webitel-wfm
          build:
            binary-name: webitel-wfm
            ldflags: >
              -s -w
              -X github.com/webitel/webitel-wfm/cmd.version=${{ needs.prepare.outputs.version }}-${{ needs.prepare.outputs.version-build }}
              -X github.com/webitel/webitel-wfm/cmd.commit=${{ github.sha }}
              -X github.com/webitel/webitel-wfm/cmd.branch=${{ github.ref_name }}

            package-contents: |
              src=deploy/systemd/${{ vars.SERVICE_NAME }}.service dst=/etc/systemd/system/${{ vars.SERVICE_NAME }}.service type=config

            scripts: |
              preinstall: deploy/debian/preinst.sh
              postinstall: deploy/debian/postinst.sh
              preremove: deploy/debian/prerm.sh
              
